name: Trigger Cron Jobs

on:
  schedule:
    # Daily Motivation: 6:00 AM UTC
    - cron: '0 6 * * *'
    # Streak Recalculation: 00:00 AM UTC (Midnight)
    - cron: '0 0 * * *'
    # Task Reminders: Every 3 Hours
    - cron: '0 */3 * * *'
    # Weekly Summary: 9:00 AM UTC on Sundays
    - cron: '0 9 * * 0'
  workflow_dispatch: # Allows manual triggering for testing

jobs:
  cron-scheduler:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Daily Motivation (6 AM)
        if: github.event.schedule == '0 6 * * *' || github.event_name == 'workflow_dispatch'
        run: |
          curl -X GET https://rt-akib.vercel.app/api/cron/daily-motivation \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          -H "Content-Type: application/json"

      - name: Trigger Streak Recalculation (Midnight)
        if: github.event.schedule == '0 0 * * *' || github.event_name == 'workflow_dispatch'
        run: |
          curl -X GET https://rt-akib.vercel.app/api/cron/streak-recalculation \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          -H "Content-Type: application/json"

      - name: Trigger Task Reminders (Every 3 Hours)
        if: github.event.schedule == '0 */3 * * *' || github.event_name == 'workflow_dispatch'
        run: |
          curl -X GET https://rt-akib.vercel.app/api/cron/task-reminders \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          -H "Content-Type: application/json"

      - name: Trigger Weekly Summary (Sunday 9 AM)
        if: github.event.schedule == '0 9 * * 0' || github.event_name == 'workflow_dispatch'
        run: |
          curl -X GET https://rt-akib.vercel.app/api/cron/weekly-summary \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          -H "Content-Type: application/json"
